document.querySelectorAll=function(e){function t(e,t){for(var n="last"===t?e.lastChild:e.firstChild,r="last"===t?"previousSibling":"nextSibling";n&&1!==n.nodeType;)n=n[r];return n}function n(e){var t;return(t=m.attr.exec(e))?{name:t[1],operator:t[2],value:t[3]}:void 0}function r(e,t){return e.indexOf(t)>-1}function a(e){var t="",n=e.charAt(0);return $[n]||(t+="0"),r(e,"#")&&(t+="1"),r(e,".")&&(t+="2"),r(e,"[")&&(t+="3"),r(e,":")&&(t+="4"),t}function i(e,t,r){var a,i,u=E[e],l=m[u],o=0;if(2===e){for(i=[];a=l.exec(r);)i[o++]=a[1];t[u]=i}else 3===e?t[u]=n(r):t[u]=l.exec(r)[1]}function u(e,t,n){for(var r={string:e},u=e.charAt(0),l=a(e),o=l.length;o--;)i(l.charAt(o)-0,r,e);return r.attr&&"name"===r.attr.name&&r.attr.value?r.type="name":r.type=$[u]||"tag",r}function l(e){var t,n=[];for(t in e)e[t]&&O[t]&&(O[t].type=t,n.push(O[t]));return function(t){for(var r=n.length;r--;)if(!1===n[r](t,e[n[r].type]))return!1;return!0}}function o(e,t){var n;if("string"==typeof e&&(e=A(e).replace(v," ").replace(/([\>\+\~])/g," $1 ")),n=h.exec(e)){var r=n[2],a=n[3];if("#"===r)return x(a);if(g===r)return b(a);if("."===r)return w(a,n[1])}return c(e)}function c(e){for(var t,n,r,i,l,o=[],c=e.split(","),s=(1==c.length,c.length);s--;)t=c[s].split(/\s+/),n=t.pop(),i=a(n),r=u(n),r.id?l=x(r.id):"name"===r.type?l=N(r.attr.value):r.classes?l=w(r.classes,r.tag,doc,r.attr):r.tag&&(l=b(r.tag)),i.length>1&&(l=f(l,r)),t.length?(l.validNodeIndex={},o=d(l,t)):o=l;return o}function f(e,t){for(var n,r=(t.type,l(t)),a=0,i=0,u=e.length,o=[];u>a;a++)n=e[a],r(n)&&(o[i++]=n);return o}function s(e,t){y[t.name]&&(t.name=y[t.name]);var n=e.getAttribute(t.name),r=t.operator,a=t.value;return null==n?"!="===r:r?(n+="","="===r?n===a:"!="===r?n!==a:"^="===r?a&&0===n.indexOf(a):"*="===r?a&&n.indexOf(a)>-1:"$="===r?a&&n.slice(-a.length)===a:"~="===r?(" "+n+" ").indexOf(a)>-1:"|="===r?n===a||n.slice(0,a.length+1)===a+"-":!1):!1===n?!1:!0}function d(t,n){var r,a,i,o,c,f=n.pop(),s=(">"===f||"~"===f||"+"===f)&&f,f=s?n.pop():f,v=0===n.length,h="parentNode",m=u(f),y=l(m),x=[],N=0,b=0,w=t.length,A=!0;for(s&&(">"!==s&&(h="previousSibling"),r="~"!==s),o=t.validNodeIndex;w>N;N++)if(o[N]!==!1){for(a=t[N],i=a[h],c=!1;i&&1==i.nodeType&&i!==e.body&&i!==p;){if(y(i)===!0){c=!0,v&&(x[b++]=a);break}if(r)break;i=i[h]}o[N]=c,c&&A&&(A=!1)}return A?null:v?(t.validNodeIndex=g,x.length?x:null):d(t,n)}var g,p=e.documentElement,v=(e.body,/\s+/g),h=/^([\w-_]+)?(#|\.)?([\w-_]+)$/,m={id:/#([\w-]+)/,classes:/\.([\w-]+)/g,tag:/([a-z]\w+)/,attr:/\[([\w-]+)([\!\*\^\$\~\|]?\=)?(\w+)?\]/g,pseudo:/\:(first-child|last-child)+/g},y={},x=function(t){return e.getElementById(t)},N=function(t){return e.getElementsByName(t)},b=function(t,n){return(n||e).getElementsByTagName(t)},w=function(e,t,n,r){for(var a,i=b(t||"*",n),u=[],l=0,o=0,c=!!r;a=i[l++];)(!c||s(a,r))&&O.classes(a,e)&&(u[o++]=a);return u},A=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},O={id:function(e,t){return e.getAttribute("id")===t},classes:function(e,t){for(var n=" "+e.className+" ",r=t.length;r--;)if(n.indexOf(" "+t[r]+" ")<0)return!1;return!0},tag:function(e,t){return e.tagName===t.toUpperCase()},attr:s,"first-child":function(e){return e===t(e.parentNode)},"last-child":function(e){return e===t(e.parentNode,"last")}},$={".":"classes","#":"id","[":"attr",":":"pseudo"},E=["tag","id","classes","attr","pseudo"];return o}(document);